apiVersion: triggers.tekton.dev/v1alpha1
kind: EventListener
metadata:
  name: event-listener
spec:
  triggers:
    - bindings:
        - name: header
          value: $(header)
        - name: body
          value: $(body)
      template:
        params:
          - name: header
          - name: body
        resourcetemplates:
          - apiVersion: v1
            kind: ConfigMap
            metadata:
              name: event-$(uid)
            data:
              header: $(tt.params.header)
              body: $(tt.params.body)
          - apiVersion: tekton.dev/v1beta1
            kind: PipelineRun
            metadata:
              generateName: pipeline-event-test-
            spec:
              pipelineRef:
                name: pipeline
              workspaces:
                - name: event
                  configmap:
                    name: event-$(uid)
